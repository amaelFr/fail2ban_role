---
$schema: http://json-schema.org/draft-07/schema#
$id: schemas/fail2ban_jails
description: fail2ban jails configuration schema
type: object
# required:
#   - filter
#   -
additionalProperties: false
patternProperties:
  ^.*$: 
    type: object
    anyOf:
      - properties:
          enabled: { type: boolean, default: true }
        
          specific:
            type: array
            items:
              type: object
              additionalProperties: false
              patternProperties:
                .*: { type: [ string, number ] }
    
      # additionalProperties: false
      - patternProperties:
          ^.*$: { type: [ string, number ] }
    required: [ filter, enabled ]
